<div class="profile-container">
    <!-- Header Section -->
    <header class="profile-header">
        <div class="header-content">
       
            <button class="back-btn" (click)="goBack()">‚Üê Back to Dashboard</button>
            <h1>User Profile</h1>
        </div>
    </header>
     <app-notification></app-notification>
    <!-- Main Profile Content -->
    <main class="profile-content">
        <div *ngIf="errorMessage" class="notification error">
            {{ errorMessage }}
        </div>

        <!-- Loading State -->
        <div *ngIf="loading" class="loading">
            <p>Loading profile...</p>
        </div>

        <!-- Profile Information -->
        <div *ngIf="!loading" class="profile-sections">
            <!-- User Info Section -->
            <section class="user-info-section">
                <div class="section-header">
                    <h2>Personal Information</h2>
                    <button class="edit-btn" (click)="toggleEdit()" *ngIf="!isEditing">Edit Profile</button>
                    <div class="edit-actions" *ngIf="isEditing">
                        <button class="save-btn" (click)="saveProfile()">Save</button>
                        <button class="cancel-btn" (click)="cancelEdit()">Cancel</button>
                    </div>
                </div>

                <div class="user-info-grid">
                    <!-- Username -->
                    <div class="info-item">
                        <label class="info-label">Username</label>
                        <div *ngIf="!isEditing" class="info-value">{{ userProfile.username }}</div>
                        <input *ngIf="isEditing" [(ngModel)]="editProfile.username" class="info-input" type="text">
                    </div>

                    <!-- Email -->
                    <div class="info-item">
                        <label class="info-label">Email</label>
                        <div *ngIf="!isEditing" class="info-value">{{ userProfile.email }}</div>
                        <input *ngIf="isEditing" [(ngModel)]="editProfile.mail" class="info-input" type="email">
                    </div>

                    <!-- Age -->
                    <div class="info-item">
                        <label class="info-label">Age</label>
                        <div *ngIf="!isEditing" class="info-value">{{ userProfile.age || 'Not specified' }}</div>
                        <input *ngIf="isEditing" [(ngModel)]="editProfile.age" class="info-input" type="number" min="1" max="150">
                    </div>

                    <!-- Bio -->
                    <div class="info-item bio-item">
                        <label class="info-label">Bio</label>
                        <div *ngIf="!isEditing" class="info-value bio-value">{{ userProfile.bio || 'No bio available' }}</div>
                        <textarea *ngIf="isEditing" [(ngModel)]="editProfile.bio" class="info-textarea" placeholder="Tell us about yourself..."></textarea>
                    </div>
                </div>
            </section>

            <!-- My Posts Section -->
            <section class="my-posts-section">
                <div class="section-header">
                    <h2>My Posts</h2>
                    <button class="load-posts-btn" (click)="loadUserPosts()">Refresh Posts</button>
                </div>

                <!-- Posts Stats -->
                <div class="posts-stats">
                    <div class="stat-item">
                        <span class="stat-number">{{ userPosts.length }}</span>
                        <span class="stat-label">Total Posts</span>
                    </div>
                </div>

                <!-- Posts List -->
                <div class="posts-list" *ngIf="userPosts && userPosts.length > 0">
                    <div class="post-card" *ngFor="let post of userPosts">
                        <!-- Normal Post View -->
                        <div *ngIf="editingPostId !== post.id">
                            <div class="post-header">
                                <h3 class="post-title">{{ post.title }}</h3>
                                <span class="post-date">{{ post.createdAt | date:'short' }}</span>
                            </div>
<p class="post-excerpt">
  {{ post.content ? (post.content | slice:0:150) : '' }}
  {{ post.content && post.content.length > 150 ? '...' : '' }}
</p>
                            <div class="post-actions">
                         
                                <button class="edit-post-btn" (click)="editPost(post.id)">Edit</button>
                                <button class="delete-btn" (click)="deletePost(post.id)">Delete</button>
                            </div>
                        </div>

                        <!-- Edit Post View -->
                        <div *ngIf="editingPostId === post.id" class="edit-post-form">
                            <div class="post-header">
                                <input type="text" [(ngModel)]="editPostData.title" class="edit-title-input" placeholder="Post Title">
                                <span class="post-date">{{ post.createdAt | date:'short' }}</span>
                            </div>
                            <textarea [(ngModel)]="editPostData.content" class="edit-text-textarea" placeholder="Write your post content..."></textarea>
                            <div class="edit-post-actions">
                                <button class="save-btn" (click)="savePost(post.id)">Save</button>
                                <button class="cancel-btn" (click)="cancelPostEdit()">Cancel</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- No Posts State -->
                <div class="no-posts" *ngIf="!userPosts || userPosts.length === 0">
                    <p>You haven't created any posts yet.</p>
                    <button class="create-post-btn" (click)="goToDashboard()">Create Your First Post</button>
                </div>
            </section>
        </div>
    </main>
</div>